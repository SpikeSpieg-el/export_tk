/* --- mobile.css --- */

@media (hover: none) and (pointer: coarse) {
    /* Глобальные настройки для тач-устройств */
    
    /* Увеличиваем размер скроллбаров для удобства */
    ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }
    
    /* Блокируем выделение текста и зум всей страницы */
    body {
        user-select: none;
        -webkit-user-select: none;
        touch-action: none;
        overflow: hidden;
    }

    /* === 1. УЛУЧШЕНИЕ МОДАЛЬНЫХ ОКОН === */
    .modal-content, 
    .export-modal-content, 
    .handbook-modal-content, 
    .logistics-modal-v2 {
        width: 100% !important;
        height: 100% !important;
        max-width: 100vw !important;
        max-height: 100vh !important;
        border-radius: 0;
        display: flex;
        flex-direction: column;
    }

    .modal-body {
        flex: 1;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch; /* Плавный скролл на iOS */
        padding-bottom: 80px; /* Отступ снизу, чтобы контент не перекрывался баром */
    }

    /* === 2. ФИКСИРОВАННЫЙ ТУЛТИП (ВМЕСТО ПЛАВАЮЩЕГО) === */
    /* Тултип больше не летает за пальцем, а закреплен сверху/снизу */
    #canvas-tooltip {
        position: fixed !important;
        top: auto !important;
        bottom: 20px !important; /* Закреплен снизу по центру */
        left: 50% !important;
        transform: translateX(-50%) !important;
        width: 90%;
        max-width: 400px;
        background: rgba(15, 23, 42, 0.95) !important;
        border: 1px solid rgba(255, 255, 255, 0.2) !important;
        box-shadow: 0 -4px 20px rgba(0,0,0,0.5) !important;
        z-index: 9000;
        pointer-events: none;
        padding: 12px !important;
        font-size: 14px !important;
        border-radius: 12px !important;
        display: none; /* JS будет переключать */
    }

    /* === 3. КНОПКИ УПРАВЛЕНИЯ === */
    #ui-buttons {
        bottom: 25px;
        right: 15px;
        gap: 15px;
    }

    .floating-button {
        width: 56px; /* Крупнее для пальца */
        height: 56px;
        font-size: 24px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.4);
    }

    /* Кнопка строительства - самая главная */
    #open-build-menu {
        width: 72px;
        height: 72px;
        background: linear-gradient(135deg, #3182ce, #2c5282);
        border: 2px solid rgba(255,255,255,0.2);
        bottom: 25px;
        right: 25px;
    }

    /* === 4. МЕНЮ СТРОИТЕЛЬСТВА (BOTTOM SHEET) === */
    .floating-menu {
        width: 100% !important;
        height: 50vh !important;
        left: 0 !important;
        right: 0 !important;
        bottom: 0 !important;
        border-radius: 20px 20px 0 0;
        max-height: none;
        animation: slideUpMobile 0.3s ease-out;
    }

    @keyframes slideUpMobile {
        from { transform: translateY(100%); }
        to { transform: translateY(0); }
    }

    .build-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); /* Плитка */
        gap: 10px;
        padding-bottom: 40px;
    }

    .build-button {
        height: 100%;
        min-height: 120px;
    }

    /* === 5. ЛАНДШАФТНЫЙ РЕЖИМ (ТЕЛЕФОНЫ) === */
    @media (orientation: landscape) and (max-height: 600px) {
        #hud {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 40px;
            padding: 0 10px;
            overflow-x: auto;
            white-space: nowrap;
            display: block; /* Строчный режим */
        }
        
        #stats, #resources {
            display: inline-flex;
            margin-right: 20px;
        }

        #game-container {
            height: 100vh;
            padding-top: 45px; /* Место под HUD */
        }

        .floating-menu {
            width: 400px !important; /* Сбоку, а не снизу */
            height: 100vh !important;
            right: 0 !important;
            left: auto !important;
            top: 0 !important;
            border-radius: 20px 0 0 20px;
        }
    }
}

/* Эффект нажатия (Ripple) */
.touch-ripple {
    position: fixed;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    transform: scale(0);
    animation: rippleAnim 0.4s linear;
    pointer-events: none;
    z-index: 9999;
}

@keyframes rippleAnim {
    to {
        transform: scale(2.5);
        opacity: 0;
    }
}